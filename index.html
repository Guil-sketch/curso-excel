<!doctype html>
<html lang="pt-br" data-theme="system">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Curso de Excel</title>

  <!-- Favicon -->
  <link rel="icon" type="image/png" href="logo.png" />

  <!-- Styles -->
  <link rel="stylesheet" href="style.css" />

  <!-- Meta -->
  <meta name="color-scheme" content="light dark" />
  <meta name="description" content="Curso de Excel - GitHub Pages" />
</head>
<body>
  <!-- Barra de progresso de scroll -->
  <div class="scroll-progress" aria-hidden="true">
    <div class="scroll-progress__bar" id="scrollBar"></div>
  </div>

  <!-- Navbar -->
  <header class="navbar" role="banner">
    <div class="container navbar__inner">
      <a class="brand" href="#">
        <img src="logo_transparente.png" alt="Curso de Excel" height="36" />
        <span class="brand__text">Curso de Excel</span>
      </a>

      <nav class="nav-actions" aria-label="A√ß√µes">
        <button id="themeToggle" class="btn btn-ghost" aria-label="Alternar tema" title="Alternar tema">
          <span class="icon" aria-hidden="true">üåì</span>
          <span class="hide-sm">Tema</span>
        </button>
        <a class="btn btn-primary" href="#contato" title="Ir para contato">Contato</a>
      </nav>
    </div>
  </header>

  <main class="container content" id="topo">
    <section class="hero">
      <h1>Curso de Excel</h1>
      <p>Aprenda do b√°sico ao avan√ßado com exemplos pr√°ticos.</p>
    </section>

    <!-- Abas 1 (independentes) -->
    <section class="card" aria-labelledby="abas1-titulo">
      <h2 id="abas1-titulo" class="sr-only">Conte√∫dos principais</h2>

      <div class="tabs" data-tabs>
        <div class="tablist" role="tablist" aria-label="M√≥dulos do curso">
          <button class="tab is-active" role="tab" aria-selected="true" aria-controls="tab1-pane1" id="tab1-1">Introdu√ß√£o</button>
          <button class="tab" role="tab" aria-selected="false" aria-controls="tab1-pane2" id="tab1-2">F√≥rmulas</button>
          <button class="tab" role="tab" aria-selected="false" aria-controls="tab1-pane3" id="tab1-3">Fun√ß√µes</button>
          <button class="tab" role="tab" aria-selected="false" aria-controls="tab1-pane4" id="tab1-4">Tabelas</button>
        </div>

        <div class="tabpanel is-active" role="tabpanel" id="tab1-pane1" aria-labelledby="tab1-1">
          <h3>Introdu√ß√£o</h3>
          <p>Interface, c√©lulas, linhas, colunas, formata√ß√£o b√°sica e atalhos √∫teis.</p>
        </div>
        <div class="tabpanel" role="tabpanel" id="tab1-pane2" aria-labelledby="tab1-2" hidden>
          <h3>F√≥rmulas</h3>
          <p>Soma, subtra√ß√£o, refer√™ncia relativa/absoluta e preced√™ncia de operadores.</p>
        </div>
        <div class="tabpanel" role="tabpanel" id="tab1-pane3" aria-labelledby="tab1-3" hidden>
          <h3>Fun√ß√µes</h3>
          <p><code>SOMASES</code>, <code>PROCV/XPROCV</code>, <code>√çNDICE+CORRESP</code>, datas e textos.</p>
        </div>
        <div class="tabpanel" role="tabpanel" id="tab1-pane4" aria-labelledby="tab1-4" hidden>
          <h3>Tabelas</h3>
          <p>Tabelas estruturadas, filtros, segmenta√ß√µes de dados e formata√ß√µes r√°pidas.</p>
        </div>
      </div>
    </section>

    <!-- Abas 2 (independentes das Abas 1) -->
    <section class="card" aria-labelledby="abas2-titulo">
      <h2 id="abas2-titulo" class="sr-only">Recursos avan√ßados</h2>

      <div class="tabs" data-tabs>
        <div class="tablist" role="tablist" aria-label="Recursos avan√ßados">
          <button class="tab is-active" role="tab" aria-selected="true" aria-controls="tab2-pane1" id="tab2-1">Valida√ß√£o</button>
          <button class="tab" role="tab" aria-selected="false" aria-controls="tab2-pane2" id="tab2-2">Gr√°ficos</button>
          <button class="tab" role="tab" aria-selected="false" aria-controls="tab2-pane3" id="tab2-3">Dashboards</button>
        </div>

        <div class="tabpanel is-active" role="tabpanel" id="tab2-pane1" aria-labelledby="tab2-1">
          <h3>Valida√ß√£o de Dados</h3>
          <p>Listas suspensas, restri√ß√µes num√©ricas, mensagens de entrada e alertas de erro.</p>
        </div>
        <div class="tabpanel" role="tabpanel" id="tab2-pane2" aria-labelledby="tab2-2" hidden>
          <h3>Gr√°ficos</h3>
          <p>Colunas, linhas, pizza, combo e dicas de design para leitura clara.</p>
        </div>
        <div class="tabpanel" role="tabpanel" id="tab2-pane3" aria-labelledby="tab2-3" hidden>
          <h3>Dashboards</h3>
          <p>Indicadores, segmenta√ß√µes, layout responsivo e boas pr√°ticas de narrativa visual.</p>
        </div>
      </div>
    </section>

    <section id="contato" class="card">
      <h2>Contato</h2>
      <p>D√∫vidas? Fale comigo pelo WhatsApp.</p>
      <a class="btn btn-outline" href="https://wa.me/5500000000000" target="_blank" rel="noopener" aria-label="Abrir conversa no WhatsApp">
        <svg class="wa-icon" viewBox="0 0 32 32" aria-hidden="true">
          <path d="M16 2.75A13.25 13.25 0 0 0 4.47 23.16L3 29l6-.93A13.25 13.25 0 1 0 16 2.75Zm0 2.5A10.75 10.75 0 0 1 26.75 16c0 5.93-4.83 10.75-10.75 10.75a10.7 10.7 0 0 1-5.5-1.54l-.4-.24-3.6.55.87-3.46-.26-.42A10.7 10.7 0 0 1 5.25 16C5.25 9.98 10 5.25 16 5.25Zm-4.16 4.93c-.25-.56-.51-.57-.74-.58h-.63c-.22 0-.58.08-.88.43s-1.15 1.12-1.15 2.73 1.18 3.17 1.34 3.39 2.28 3.65 5.52 4.97c2.73 1.13 3.29.91 3.88.85s1.91-.78 2.18-1.54.27-1.41.19-1.54-.3-.22-.63-.39-.91-.45-1.05-.5-.24-.08-.35.08-.4.5-.49.61-.18.14-.34.11a8.8 8.8 0 0 1-2.62-1.61 9.78 9.78 0 0 1-1.81-2.25c-.19-.32 0-.49.14-.66s.31-.35.47-.53.22-.31.33-.52.05-.39-.03-.54-.74-1.79-1.04-2.45Z"/>
        </svg>
        WhatsApp
      </a>
    </section>
  </main>

  <!-- Bot√µes flutuantes -->
  <button id="toTop" class="to-top" aria-label="Voltar ao topo" title="Voltar ao topo">‚Üë</button>
  <a class="wa-fab" href="https://wa.me/5500000000000" target="_blank" rel="noopener" aria-label="WhatsApp">
    <svg class="wa-icon" viewBox="0 0 32 32" aria-hidden="true">
      <path d="M16 2.75A13.25 13.25 0 0 0 4.47 23.16L3 29l6-.93A13.25 13.25 0 1 0 16 2.75Zm0 2.5A10.75 10.75 0 0 1 26.75 16c0 5.93-4.83 10.75-10.75 10.75a10.7 10.7 0 0 1-5.5-1.54l-.4-.24-3.6.55.87-3.46-.26-.42A10.7 10.7 0 0 1 5.25 16C5.25 9.98 10 5.25 16 5.25Zm-4.16 4.93c-.25-.56-.51-.57-.74-.58h-.63c-.22 0-.58.08-.88.43s-1.15 1.12-1.15 2.73 1.18 3.17 1.34 3.39 2.28 3.65 5.52 4.97c2.73 1.13 3.29.91 3.88.85s1.91-.78 2.18-1.54.27-1.41.19-1.54-.3-.22-.63-.39-.91-.45-1.05-.5-.24-.08-.35.08-.4.5-.49.61-.18.14-.34.11a8.8 8.8 0 0 1-2.62-1.61 9.78 9.78 0 0 1-1.81-2.25c-.19-.32 0-.49.14-.66s.31-.35.47-.53.22-.31.33-.52.05-.39-.03-.54-.74-1.79-1.04-2.45Z"/>
    </svg>
  </a>

  <!-- Toasts -->
  <div id="toastContainer" class="toast-container" aria-live="polite" aria-atomic="true"></div>

  <!-- Scripts -->
  <script>
    // --------- Tema (light/dark/system) ----------
    (function initTheme() {
      const root = document.documentElement;
      const saved = localStorage.getItem('theme') || 'system';
      root.setAttribute('data-theme', saved);
      applyTheme(saved);

      document.getElementById('themeToggle').addEventListener('click', () => {
        const current = document.documentElement.getAttribute('data-theme') || 'system';
        const next = current === 'light' ? 'dark' : current === 'dark' ? 'system' : 'light';
        localStorage.setItem('theme', next);
        document.documentElement.setAttribute('data-theme', next);
        applyTheme(next);
        toast(`Tema: ${next}`);
      });

      function applyTheme(mode) {
        if (mode === 'system') {
          document.documentElement.removeAttribute('data-user-theme');
        } else {
          document.documentElement.setAttribute('data-user-theme', mode);
        }
      }
    })();

    // --------- Abas independentes ----------
    document.querySelectorAll('[data-tabs]').forEach(initTabs);
    function initTabs(tabsRoot) {
      const tabs = Array.from(tabsRoot.querySelectorAll('[role="tab"]'));
      const panels = Array.from(tabsRoot.querySelectorAll('[role="tabpanel"]'));

      tabs.forEach(tab => {
        tab.addEventListener('click', () => activateTab(tab));
        tab.addEventListener('keydown', (e) => {
          const i = tabs.indexOf(tab);
          if (e.key === 'ArrowRight') { e.preventDefault(); tabs[(i+1)%tabs.length].focus(); }
          if (e.key === 'ArrowLeft') { e.preventDefault(); tabs[(i-1+tabs.length)%tabs.length].focus(); }
          if (e.key === 'Home') { e.preventDefault(); tabs[0].focus(); }
          if (e.key === 'End') { e.preventDefault(); tabs[tabs.length-1].focus(); }
          if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); activateTab(tab); }
        });
      });

      function activateTab(selected) {
        tabs.forEach(t => {
          const active = t === selected;
          t.classList.toggle('is-active', active);
          t.setAttribute('aria-selected', active ? 'true' : 'false');
          const paneId = t.getAttribute('aria-controls');
          const panel = tabsRoot.querySelector('#' + paneId);
          if (panel) {
            panel.classList.toggle('is-active', active);
            panel.hidden = !active;
          }
        });
      }
    }

    // --------- Voltar ao topo ----------
    const toTopBtn = document.getElementById('toTop');
    window.addEventListener('scroll', () => {
      const y = window.scrollY || document.documentElement.scrollTop;
      toTopBtn.classList.toggle('show', y > 200);

      // progresso de scroll
      const h = document.documentElement.scrollHeight - document.documentElement.clientHeight;
      const p = (y / h) * 100;
      document.getElementById('scrollBar').style.width = p + '%';
    });
    toTopBtn.addEventListener('click', () => {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    });

    // --------- Toasts ----------
    function toast(message, timeout = 2600) {
      const container = document.getElementById('toastContainer');
      const el = document.createElement('div');
      el.className = 'toast';
      el.setAttribute('role', 'status');
      el.textContent = message;
      container.appendChild(el);
      requestAnimationFrame(() => el.classList.add('show'));
      setTimeout(() => {
        el.classList.remove('show');
        el.addEventListener('transitionend', () => el.remove(), { once: true });
      }, timeout);
    }

    // Mensagem de acessibilidade quando abas trocam (exemplo)
    document.addEventListener('click', (e) => {
      if (e.target.matches('.tab')) {
        const label = e.target.textContent.trim();
        toast(`Aba: ${label}`);
      }
    });
  </script>
</body>
</html>
